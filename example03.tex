% !TeX root = example03.tex
% !TeX program = xelatex

\input{tikz_preamble}

\pgfplotsset{/pgfplots/group/every plot/.style={
    title style={at={(0.5,-0.3)},
        xshift=0pt,
        yshift=-18.0pt,
        above}
        }
    }

\begin{document}
\pagestyle{empty}

\begin{tikzpicture}[
    fill between/on layer={
    axis grid
    },]
 \begin{groupplot}[
     group style = {group size = 3 by 1,horizontal sep=1.3cm},
     height = 10cm,
     width = 6.5 in,
    ]
	\nextgroupplot[standard,
		set layers,
		cell picture=true,
		title={\hspace{-0.4cm}(a) $\Wi = 0.4$, $\De = 0.07$},
		xlabel={$t/T$},
		ylabel={$\rVert \vbEps[t]  \lVert$},
		ymode=log,
		xmin=0,
		%ymin=1,
		xmax=4.5, ymax=0.01,
		%ymax=100,
		xtick={0,2.25,4.5},
		xticklabels={0,0.5,1},
		/pgfplots/tick scale binop=\times,
		enlarge x limits=0.,enlarge y limits=0.,
		height=0.23\textwidth,
		width=0.27\textwidth,
		legend style={at={(axis cs:7,0.02)},
			anchor=north,legend columns=2,draw=none,legend cell align=left,transpose legend},
		legend style={/tikz/every even column/.append style={column sep=0.5cm}}
		]
		\addplot+[RYB1,no markers,smooth,very thick] table{data/verif/ca2.5_T4.5/dns1.csv};
		\addplot+[RYB1,no markers,smooth,dashed,very thick] table{data/verif/ca2.5_T4.5/pre1.csv};
		\addplot+[RYB2,no markers,smooth,very thick] table{data/verif/ca2.5_T4.5/dns4.csv};
		\addplot+[RYB2,no markers,smooth,dashed,very thick] table{data/verif/ca2.5_T4.5/pre4.csv};
		\draw[thick,dotted] (axis cs:0,0.0057) -- (axis cs:4.5,0.0057);
		\node[above] at (axis cs:1,0.0057) {$\heps \Delta$};

		\node at (axis cs:4,0.0019) 	{\footnotesize{\color{RYB1} (i)}};
		\node at (axis cs:2.25,0.0066)	{\footnotesize{\color{RYB2} (iii)}};
		\node at (axis cs:4,0.0027) 	{\footnotesize{\color{RYB1} (ii)}};
		\node at (axis cs:2.25,0.0049) 	{\footnotesize{\color{RYB2} (iv)}};
		
		\legend{
			{\color{RYB1} (i) $\heps \vbv_\eta$ i.c., DNS},
			{\color{RYB1} (ii) $\heps \mathbf{X}(t) \vbv_\eta$},
			{\color{RYB2} (iii) $\heps \vbv_\Delta$ i.c., DNS},
			{\color{RYB2} (iv) $\heps \mathbf{X}(t) \vbv_\Delta$},
			};

	\nextgroupplot[standard,
		set layers,
		cell picture=true,
		title={\hspace{-0.3cm}(b) $\Wi = 0.8$, $\De = 0.03$},
		xlabel={$t/T$},
		ymode=log,
		xmin=0,
		xmax=10,ymax=10,
		xtick={0,5,10},
		xticklabels={0,0.5,1},
		ytick={0.001,0.01,0.1,1,10},
		/pgfplots/tick scale binop=\times,
		enlarge x limits=0.,
        enlarge y limits=0.,
		height=0.23\textwidth,
		width=0.27\textwidth,
		]
		\addplot+[RYB1,no markers,smooth,thick] table{data/verif/ca5_T10/dns1.csv};
		\addplot+[RYB1,no markers,smooth,dashed,thick] table{data/verif/ca5_T10/pre1.csv};
		\addplot+[RYB2,no markers,smooth,thick] table{data/verif/ca5_T10/dns5.csv};
		\addplot+[RYB2,no markers,smooth,dashed,thick] table{data/verif/ca5_T10/pre5.csv};
		\path[name path=axis2] (axis cs:0,10) -- (axis cs:10,10);
		\draw[thick,dotted] (axis cs:0,2.2) -- (axis cs:10,2.2);
		\node[above] at (axis cs:2.2,2.2) {$\heps \Delta$};
		
		
		\node at (axis cs:4.5,0.002) 	{\footnotesize{\color{RYB1} (i)}};
		\node at (axis cs:5,3.6)		{\footnotesize{\color{RYB2} (iii)}};
		\node at (axis cs:4.5,0.007) 	{\footnotesize{\color{RYB1} (ii)}};
		\node at (axis cs:5,1.3) 		{\footnotesize{\color{RYB2} (iv)}};
	\nextgroupplot[standard,
		set layers,
		cell picture=true,
		title={\hspace{-0.24cm}(c) $\Wi = 3.2$, $\De = 0.04$},
		xlabel={$t/T$},
		yminorticks=true,
		ymode=log,
		xmin=0,ymin=0.001,
		xmax=3, ymax=100000,
		xtick={0,1.5,3},
		xticklabels={0,0.19,0.38},
		/pgfplots/tick scale binop=\times,
		enlarge x limits=0.,
        enlarge y limits=0.,
		height=0.23\textwidth,
		width=0.15\textwidth,
		ytick={0.001,0.1,10,1000,100000},
		]
		
		\node[above,black] at (axis cs:1.0,113) {$L$};
		\addplot+[black,thick,dashed,domain=0:2.15,no markers,samples=5,forget plot] {113};

		\addplot+[RYB2,no markers,smooth,thick] table{data/verif/ca20_T7.85/dns.csv};
		\addplot+[RYB2,no markers,smooth,dashed,thick] table{data/verif/ca20_T7.85/pre.csv};
		\path[name path=axis3] (axis cs:0,100000) -- (axis cs:3,100000);
				
		\node[below] at (axis cs:2.5,100)	{\footnotesize{\color{RYB2} (iii)}};
		\node at (axis cs:1,1) 			{\footnotesize{\color{RYB2} (iv)}};
\end{groupplot}	
\end{tikzpicture}


\end{document}
